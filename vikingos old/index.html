<!DOCTYPE html>
<html lang="es">
<head>
  <!-- Favicon est√°ndar -->
<link rel="icon" type="image/x-icon" href="favicon.png">
  <meta charset="UTF-8">
  <title>El Hilo de las Nornas | Un Portal R√∫nico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  
  <style>
    /* --- TEMA NOCHE (FUEGO Y SOMBRA) - POR DEFECTO --- */
    :root {
      --color-bg: #0a141d; --color-surface: rgba(10, 20, 30, 0.65); --color-border: rgba(107, 79, 53, 0.4); --color-text-main: #c5b8a3; --color-text-header: #e6d9c1; --color-accent-primary: #d4af37; --color-accent-secondary: #6b4f35; --color-modal-bg: #f2e8d5; --color-modal-text: #6b4f35; --transition-speed: 0.4s;
    }
    
    /* --- TEMA D√çA (NATURALEZA Y PIEDRA) --- */
    body.theme-day {
      --color-bg: #d7c7ad; --color-surface: rgba(242, 232, 213, 0.65); --color-border: rgba(105, 116, 88, 0.4); --color-text-main: #5d5345; --color-text-header: #3e3529; --color-accent-primary: #8c6d4e; --color-accent-secondary: #a8987f; --color-modal-bg: #3e3529; --color-modal-text: #f2e8d5;
    }

    *, *::before, *::after { box-sizing: border-box; }
    body { background-color: var(--color-bg); color: var(--color-text-main); font-family: 'Roboto', sans-serif; margin: 0; overflow-x: hidden; transition: background-color var(--transition-speed), color var(--transition-speed); }
    .world-background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, var(--color-bg), #142331); z-index: -1; transition: background var(--transition-speed); }
    body.theme-day .world-background { background: linear-gradient(to bottom, var(--color-bg), #bfae91); }
    #particles-js { position:fixed; width: 100%; height: 100%; top: 0; left: 0; z-index: 0; }
    .app-container { max-width: 1200px; margin: 0 auto; padding: 1rem; position: relative; z-index: 2; }
    header { display: flex; justify-content: space-between; align-items: center; padding: 1rem 0.5rem; border-bottom: 1px solid rgba(212, 175, 55, 0.2); margin-bottom: 2rem; transition: border-color var(--transition-speed); }
    body.theme-day header { border-bottom-color: rgba(105, 116, 88, 0.4); }
    .logo-container { display: flex; align-items: center; gap: 1rem; }
    .logo-rune { font-size: 2.5rem; color: var(--color-accent-primary); text-shadow: 0 0 15px var(--color-accent-primary); animation: pulse-glow 5s ease-in-out infinite; transition: color var(--transition-speed), text-shadow var(--transition-speed); }
    header h1 { font-family: 'Cinzel Decorative', serif; font-size: 1.5rem; color: var(--color-text-header); margin: 0; letter-spacing: 2px; transition: color var(--transition-speed); }
    #main-nav { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    #main-nav a { color: var(--color-text-main); text-decoration: none; padding: 0.5rem 0.8rem; position: relative; transition: color var(--transition-speed), text-shadow var(--transition-speed); }
    #main-nav a::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 0; height: 2px; background-color: var(--color-accent-primary); transition: width var(--transition-speed), background-color var(--transition-speed); }
    #main-nav a:hover, #main-nav a.active { color: var(--color-text-header); text-shadow: 0 0 5px var(--color-accent-primary); }
    #main-nav a:hover::after, #main-nav a.active::after { width: 60%; }
    .main-section { display: none; background: var(--color-surface); border: 1px solid var(--color-border); border-radius: 16px; padding: 1.5rem; backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37); transition: background-color var(--transition-speed), border-color var(--transition-speed); }
    .main-section.active { display: block; animation: section-fade-in 0.8s ease forwards; }
    @keyframes section-fade-in { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    h2 { font-family: 'Cinzel Decorative', serif; color: var(--color-text-header); text-align: center; font-size: 2.2rem; margin-top: 0; margin-bottom: 1.5rem; text-shadow: 0 0 10px var(--color-accent-primary); transition: color var(--transition-speed), text-shadow var(--transition-speed); }
    input[type="text"], button { font-family: 'Roboto', sans-serif; border-radius: 8px; border: 1px solid var(--color-accent-secondary); padding: 0.8em 1em; background: rgba(0,0,0,0.2); color: var(--color-text-header); transition: all var(--transition-speed); }
    body.theme-day input[type="text"] { background: rgba(255,255,255,0.2); border-color: var(--color-accent-secondary); color: var(--color-text-header); }
    button { background: var(--color-accent-secondary); color: var(--color-text-header); font-weight: bold; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
    button:hover:not(:disabled) { background-color: var(--color-accent-primary); color: var(--color-bg); transform: translateY(-2px); box-shadow: 0 4px 15px var(--color-accent-primary); }
    button:disabled { cursor: not-allowed; opacity: 0.5; }
    .tipo-btn { background: transparent; border: 1px solid var(--color-accent-secondary); }
    .tipo-btn.active { background: var(--color-accent-primary); color: var(--color-bg); border-color: var(--color-accent-primary); font-weight: bold; }
    #galeria-runas { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; }
    .runa-glyph-container { text-align:center; flex: 0 0 90px; height: 110px; display: flex; flex-direction:column; align-items: center; justify-content: center; background: rgba(0,0,0,0.2); border: 1px solid var(--color-accent-secondary); border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.3); cursor: pointer; transition: all var(--transition-speed); padding-top:5px; }
    body.theme-day .runa-glyph-container { background: rgba(255,255,255,0.2); }
    .runa-glyph-container:hover { box-shadow: 0 4px 20px var(--color-accent-primary); transform: translateY(-3px) scale(1.05); background: var(--color-accent-secondary); }
    .runa-glyph { font-size: 50px; line-height: 1; color: var(--color-text-main); text-shadow: 0 0 3px var(--color-accent-primary); transition: all var(--transition-speed); animation: pulse-glow 6s ease-in-out infinite alternate; }
    /* --- NUEVO ESTILO PARA RUNAS INVERTIDAS --- */
    .runa-glyph.invertida { transform: rotate(180deg); transition: transform 0.5s ease; }
    .runa-glyph-container .runa-nombre-tag { font-size: 0.85em; margin-top: 8px; color: var(--color-text-main); transition: color var(--transition-speed); }
    .runa-glyph-container:hover .runa-glyph { color: var(--color-accent-primary); text-shadow: 0 0 8px var(--color-accent-primary); transform: scale(1.1); animation-play-state: paused; }
    .runa-glyph-container:hover .runa-glyph.invertida { transform: scale(1.1) rotate(180deg); }
    .runa-glyph-container:hover .runa-nombre-tag { color: var(--color-text-header); }
    @keyframes pulse-glow { from { text-shadow: 0 0 3px var(--color-accent-primary); } to { text-shadow: 0 0 8px var(--color-accent-primary); } }
    .runa-modal-overlay { display: none; position: fixed; z-index: 1000; inset: 0; background: rgba(10, 20, 29, 0.85); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); justify-content: center; align-items: center; animation: fadeIn 0.3s; }
    .runa-modal-overlay.active { display: flex; }
    .runa-modal { background: var(--color-modal-bg); color: var(--color-modal-text); border-radius: 16px; box-shadow: 0 8px 44px rgba(0,0,0,0.5); display: flex; gap: 32px; max-width: 650px; width: 98%; padding: 32px 28px; position: relative; animation: modalSlideUp 0.35s cubic-bezier(0.165, 0.84, 0.44, 1); transition: background-color var(--transition-speed), color var(--transition-speed); max-height: 90vh; overflow-y: auto; }
    .runa-modal-img { background: #e6d9c1; border-radius: 12px; min-height: 150px; width: 150px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: background-color var(--transition-speed); }
    body.theme-day .runa-modal-img { background: #5d5345; }
    .runa-modal-img .runa-glyph { font-size: 90px; color: var(--color-modal-text); animation: none; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
    .runa-modal-info > div { opacity: 0; animation: reveal-secret 0.5s ease forwards; }
    .runa-modal-info .runa-modal-nombre { animation-delay: 0.1s; } .runa-modal-info .runa-modal-significado { animation-delay: 0.2s; } .runa-modal-info .runa-modal-interpretacion { animation-delay: 0.4s; } .runa-modal-info .btn-saber-mas { animation-delay: 0.6s; }
    @keyframes reveal-secret { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .runa-modal-nombre { font-family: 'Cinzel Decorative', serif; font-size: 1.7em; }
    .runa-modal-significado { font-size: 1.1em; color: #8c6d4e; font-weight: 500; margin: 0.5em 0; transition: color var(--transition-speed); }
    body.theme-day .runa-modal-significado { color: #bfae91; }
    .runa-modal-interpretacion { background: #e9e2d3; border-radius: 7px; padding: 0.8em 1em; color: #3b2d1c; margin: 0.5em 0; transition: background-color var(--transition-speed), color var(--transition-speed); }
    body.theme-day .runa-modal-interpretacion { background: #4a4134; color: #d7c7ad; }
    .runa-modal-close { cursor: pointer; position: absolute; top: 12px; right: 12px; font-size: 1.8em; color: #bca170; background: none; border: none; width: 40px; height: 40px; border-radius: 50%; transition: background 0.2s, color 0.2s, transform 0.2s; }
    body.theme-day .runa-modal-close { color: #a8987f; }
    .runa-modal-close:hover { background: #e6d9c1; color: var(--color-modal-text); transform: rotate(90deg); }
    body.theme-day .runa-modal-close:hover { background: #5d5345; }
    .btn-saber-mas { background: transparent; border: 1px solid var(--color-accent-secondary); color: var(--color-accent-secondary); margin-top: 1em; padding: 0.5em 1em; font-weight: normal; }
    body.theme-day .btn-saber-mas { color: var(--color-modal-text); }
    .btn-saber-mas:hover { background: var(--color-accent-secondary); color: var(--color-modal-bg); transform: none; box-shadow: none;}
    .runa-modal-expandido h4 { font-family: 'Cinzel Decorative', serif; margin-top: 1.5em; margin-bottom: 0.5em; color: var(--color-accent-primary); border-bottom: 1px solid var(--color-border); padding-bottom: 0.3em; }
    body.theme-day .runa-modal-expandido h4 { color: var(--color-accent-secondary); border-color: var(--color-border); }
    .runa-modal-expandido p { font-size: 0.95em; line-height: 1.6; margin-top: 0; }
    .tirada-runa-box { text-align: center; background: rgba(242, 232, 213, 0.1); border: 1px solid var(--color-accent-secondary); border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.3); padding: 12px 8px 10px; min-width: 140px; transition: all var(--transition-speed); }
    .tirada-runa-box:hover, .tirada-runa-box:focus { box-shadow: 0 4px 16px var(--color-accent-primary); transform: translateY(-3px) scale(1.03); background: rgba(107, 79, 53, 0.5); border-color: var(--color-accent-primary); }
    body.theme-day .tirada-runa-box { background: rgba(255,255,255,0.1); }
    body.theme-day .tirada-runa-box:hover { background: rgba(168, 152, 127, 0.5); }
    .tirada-runa-box .runa-glyph { font-size: 60px; margin: 0.2em auto; }
    .tirada-pos { color: var(--color-text-header); font-weight: bold; }
    .tirada-nombre { font-weight: bold; font-size: 1.13em; color: var(--color-text-header); }
    .tirada-cruz-layout { display: grid; grid-template-areas: ". arriba ." "izquierda centro derecha" ". abajo ."; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-top: 10px; }
    .tirada-cruz-arriba { grid-area: arriba; } .tirada-cruz-centro { grid-area: centro; } .tirada-cruz-abajo { grid-area: abajo; } .tirada-cruz-izquierda { grid-area: izquierda; } .tirada-cruz-derecha { grid-area: derecha; }
    .fixed-controls { position: fixed; bottom: 20px; right: 20px; z-index: 100; display: flex; flex-direction: column; gap: 10px; align-items: center; }
    .fixed-controls button { background: var(--color-surface); border: 1px solid var(--color-border); border-radius: 50%; width: 50px; height: 50px; font-size: 1.5em; backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center; padding: 0; color: var(--color-text-header); }
    .theme-switcher svg { width: 24px; height: 24px; transition: all 0.5s ease; }
    .theme-switcher #icon-sun { display: none; }
    .audio-controls { display: flex; flex-direction: column; align-items: center; gap: 8px; }
    .audio-controls input[type="range"] { -webkit-appearance: none; appearance: none; width: 50px; height: 50px; background: transparent; cursor: pointer; transform: rotate(-90deg); }
    .audio-controls input[type="range"]::-webkit-slider-runnable-track { background: rgba(0,0,0,0.2); height: 4px; border-radius: 2px; border: 1px solid var(--color-border); }
    .audio-controls input[type="range"]::-moz-range-track { background: rgba(0,0,0,0.2); height: 4px; border-radius: 2px; border: 1px solid var(--color-border); }
    .audio-controls input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; margin-top: -6px; background-color: var(--color-accent-primary); height: 16px; width: 16px; border-radius: 50%; border: 2px solid var(--color-surface); }
    .audio-controls input[type="range"]::-moz-range-thumb { background-color: var(--color-accent-primary); height: 12px; width: 12px; border-radius: 50%; border: 2px solid var(--color-surface); }
    #chatbot-toggle-btn { position: fixed; bottom: 20px; left: 20px; z-index: 100; background: var(--color-surface); border: 1px solid var(--color-border); border-radius: 50%; width: 50px; height: 50px; backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center; padding: 0; color: var(--color-text-header); animation: pulse-glow 4s ease-in-out infinite alternate; }
    #chatbot-toggle-btn svg { width: 28px; height: 28px; color: var(--color-accent-primary); transition: all 0.5s ease; }
    #chatbot-overlay { display: none; position: fixed; z-index: 1010; inset: 0; background: rgba(10, 20, 29, 0.85); backdrop-filter: blur(8px); justify-content: center; align-items: center; animation: fadeIn 0.5s; }
    #chatbot-overlay.active { display: flex; }
    #chatbot-container { position: relative; width: 90%; max-width: 420px; height: 80%; max-height: 700px; }
    #chatbot-container iframe { width: 100%; height: 100%; border: 1px solid var(--color-border); border-radius: 16px; box-shadow: 0 8px 44px rgba(0,0,0,0.5); }
    #chatbot-close-btn { position: absolute; top: -15px; right: -15px; background: var(--color-modal-bg); color: var(--color-modal-text); border-radius: 50%; width: 40px; height: 40px; font-size: 1.5em; border: 1px solid var(--color-border); z-index: 10; }
    footer { text-align: center; padding: 2rem 1rem; margin-top: 2rem; color: rgba(197, 184, 163, 0.5); border-top: 1px solid rgba(212, 175, 55, 0.1); transition: all var(--transition-speed); }
    body.theme-day footer { color: rgba(62, 53, 41, 0.5); border-top-color: rgba(105, 116, 88, 0.2); }
    @media (max-width: 768px) {
      header { flex-direction: column; gap: 1rem; } header h1 { font-size: 1.4rem; text-align: center; } #main-nav { justify-content: center; }
      .runa-modal { flex-direction: column; align-items: center; }
      .tirada-cruz-layout { grid-template-areas: "arriba" "centro" "izquierda" "derecha" "abajo"; grid-template-columns: 1fr; }
      .tirada-runa-box { min-width: 80vw; }
      .tirada-runas-flex.tres-runas { flex-direction: column; align-items: center; gap: 1rem; }
    }
  </style>
</head>
<body>
  
  <div class="world-background"></div>
  <div id="particles-js"></div>

  <audio id="audio-theme-day" loop src="audio/musica-tema-claro.mp3" preload="auto"></audio>
  <audio id="audio-theme-night" loop src="audio/musica-tema-oscuro.mp3" preload="auto"></audio>

  <div class="app-container">
    <header>
      <div class="logo-container">
        <span class="logo-rune">·õü</span>
        <h1>El Hilo de las Nornas</h1>
      </div>
      <nav id="main-nav">
        <a href="#" data-section="inicio" class="active">Inicio</a>
        <a href="#" data-section="tirada">Or√°culo</a>
        <a href="#" data-section="galeria">C√≥dice R√∫nico</a>
        <a href="#" data-section="saga">La Saga</a>
      </nav>
    </header>

    <main>
      <section id="inicio" class="main-section active">
        <h2>Un Portal a la Sabidur√≠a Antigua</h2>
        <p style="text-align: center; font-size: 1.2em; max-width: 700px; margin: 0 auto 2em auto;">
          Has llegado al fiordo de Bj√∏rndal, un lugar donde el velo entre los mundos es delgado. Aqu√≠, las runas no son solo s√≠mbolos, son la voz del destino. Explora su sabidur√≠a, consulta el or√°culo o ad√©ntrate en la saga de "El Hilo de las Nornas".
        </p>
        <div style="text-align: center;">
          <button id="cta-oraculo">Consultar el Or√°culo</button>
        </div>
      </section>

      <section id="tirada" class="main-section">
        <h2>Ritual del Or√°culo</h2>
        <div style="text-align:center; margin-bottom: 2em;">
          <label for="pregunta" style="font-weight:bold; display:block; margin-bottom: 0.5em;">Graba tu pregunta en el √©ter:</label>
          <input type="text" id="pregunta" placeholder="Escribe tu consulta a las Nornas..." style="width:90%;max-width:370px;">
        </div>
        <div style="text-align:center;">
          <p>Elige el ritual que m√°s resuene con tu esp√≠ritu.</p>
          <div class="tipos-tirada" style="display:flex; justify-content:center; gap:10px; margin-bottom:1em;">
            <button class="tipo-btn active" data-tirada="simple" title="Una respuesta directa y concisa.">Una Runa</button>
            <button class="tipo-btn" data-tirada="tres" title="Pasado, Presente y Futuro.">Tres Runas</button>
            <button class="tipo-btn" data-tirada="cruz" title="An√°lisis profundo de una situaci√≥n.">Cruz R√∫nica</button>
          </div>
          <div id="explicacion-tirada" style="margin: 1em auto; max-width:500px; background: rgba(0,0,0,0.1); padding: 1em; border-radius:8px;"></div>
        </div>
        <div style="text-align:center; margin-top: 2em;">
          <button id="iniciar-ritual" disabled>Lanzar las Runas</button>
          <div id="tirada-resultado" style="margin-top:2em;"></div>
        </div>
        <template id="ejemplo-simple"><b>Una Runa:</b> Ideal para una pregunta concreta, te ofrece una gu√≠a directa.</template>
        <template id="ejemplo-tres"><b>Tres Runas:</b> Explora el flujo del tiempo: Pasado, Presente y Futuro de tu consulta.</template>
        <template id="ejemplo-cruz"><b>Cruz R√∫nica:</b> Un an√°lisis profundo: T√∫, tu Gu√≠a, la Ra√≠z del asunto, el Obst√°culo y la Soluci√≥n.</template>
      </section>

      <section id="galeria" class="main-section">
        <h2>C√≥dice de Runas</h2>
        <div id="galeria-runas"></div>
      </section>

      <section id="saga" class="main-section">
        <h2>La Saga: El Hilo de las Nornas</h2>
        <div style="max-width: 800px; margin: 0 auto; line-height: 1.7;">
          <p>En el fiordo de Bj√∏rndal, la muerte de un Jarl sin heredero amenaza con desgarrar al clan. Una joven v√∂lva, Ingrid, debe interpretar una misteriosa tirada de runas para guiar a su gente a trav√©s de una tormenta de ambici√≥n, traici√≥n y guerra inminente. La fuerza del guerrero Bj√∂rn y la astucia del comerciante Hakon se enfrentan, pero las runas susurran un secreto que ninguno de los dos puede ver...</p>
          <p><em>(Aqu√≠ se podr√° leer la saga completa, cap√≠tulo por cap√≠tulo, con sus ilustraciones)</em></p>
        </div>
      </section>
    </main>
    
    <footer>
      <p>&copy; 2025 Forjado en colaboraci√≥n. Un portal al mundo de las runas.</p>
    </footer>
  </div>
  
  <div class="runa-modal-overlay" id="runa-modal-overlay" tabindex="-1">
    <div class="runa-modal" role="dialog" aria-modal="true" aria-labelledby="runa-modal-nombre">
      <button class="runa-modal-close" id="runa-modal-close" aria-label="Cerrar modal">&times;</button>
      <div class="runa-modal-img" id="runa-modal-img"></div>
      <div class="runa-modal-info">
        <div><h3 class="runa-modal-nombre" id="runa-modal-nombre"></h3></div>
        <div><p class="runa-modal-significado" id="runa-modal-significado"></p></div>
        <div><p class="runa-modal-interpretacion" id="runa-modal-interpretacion"></p></div>
        <div><button class="btn-saber-mas" id="btn-saber-mas">Saber m√°s...</button></div>
        <div class="runa-modal-expandido" id="runa-modal-expandido" style="display: none;">
          <div id="runa-modal-titulo-wrapper">
              <h4 id="runa-modal-titulo"></h4>
          </div>
          <div id="runa-modal-significado-profundo-wrapper">
              <h4>Significado Profundo</h4>
              <p id="runa-modal-significado-profundo"></p>
          </div>
          <div id="runa-modal-invertida-wrapper">
              <h4>Valor Invertido</h4>
              <p id="runa-modal-invertida"></p>
          </div>
          <div id="runa-modal-postura-wrapper">
              <h4>Postura Corporal</h4>
              <p id="runa-modal-postura"></p>
          </div>
          <div id="runa-modal-ritual-wrapper">
              <h4>Ritual Asociado</h4>
              <p id="runa-modal-ritual"></p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="fixed-controls">
      <div class="theme-switcher">
          <button id="theme-toggle-btn" title="Cambiar tema">
              <svg id="theme-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path id="icon-moon" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                  <path id="icon-sun" d="M12 1v2m0 18v2m8.66-10.66l-1.42 1.42M4.76 4.76L3.34 6.18M23 12h-2M3 12H1m18.66-7.24l-1.42-1.42M4.76 19.24l-1.42-1.42M12 6a6 6 0 1 0 0 12 6 6 0 0 0 0-12z" style="display:none;"></path>
              </svg>
          </button>
      </div>
      <div class="audio-controls">
        <button id="mute-btn" title="Silenciar / Activar Sonido">üîá</button>
        <input type="range" id="volume-slider" min="0" max="1" step="0.05" value="0.3" title="Control de volumen">
      </div>
  </div>

  <button id="chatbot-toggle-btn" title="Consultar al Or√°culo IA">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
        <circle cx="12" cy="12" r="3"></circle>
    </svg>
  </button>

  <div id="chatbot-overlay">
    <div id="chatbot-container">
        <iframe src="https://cdn.botpress.cloud/webchat/v3.2/shareable.html?configUrl=https://files.bpcontent.cloud/2025/08/21/02/20250821024347-N68COQR2.json&theme=dark" frameborder="0"></iframe>
        <button id="chatbot-close-btn" title="Cerrar Or√°culo">&times;</button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  
  <script>
    /* --- BASE DE DATOS COMPLETA DE RUNAS CON L√ìGICA DE INVERSI√ìN --- */
    const runas = [
        { 
            nombre: 'Fehu', simbolo: '·ö†', puede_invertirse: true,
            significado_corto: 'Riqueza, abundancia, prosperidad.', 
            interpretacion: "Valora tus recursos con sabidur√≠a. Es momento de reconocer la abundancia y actuar con generosidad.",
            contenido_expandido: {
                titulo: "Abundancia de dar y recibir",
                significado_profundo: "Fehu es una antena que atrae y distribuye energ√≠a. Como primera letra del Futhark, representa el fuego comunitario, la alegr√≠a que se comparte y la abundancia que se prodiga. Simboliza los bienes m√≥viles, como el ganado o el dinero, obtenidos con esfuerzo. Es una energ√≠a que fluye por las venas de la tierra y deviene en materia, representando lo que se recibe y lo que se da, un bien colectivo que nadie puede atrapar por completo.",
                valor_invertido: "Indica una tarea in√∫til, como querer aferrar el agua entre los dedos. Se√±ala energ√≠a desperdiciada, despilfarro, malgasto de dinero o fuerza vital. Puede advertir sobre despojos o p√©rdidas cuantiosas de bienes.",
                postura: "De pie con los pies juntos. Los brazos se elevan por el frente hacia el cielo y adelante, con las palmas enfrentadas y la cabeza ligeramente levantada.",
                ritual: "El ritual de 'la atadura de los a√±os' de los pueblos originarios ilustra el mensaje de Fehu. Al final de un ciclo, todos los fuegos se apagan. Un sacerdote enciende un fuego nuevo y sagrado, distribuyendo un tiz√≥n a cada jefe de clan para que reenciendan el hogar de cada casa, simbolizando la renovaci√≥n, la abundancia y el car√°cter colectivo de la vida."
            }
        },
        { 
            nombre: 'Uruz', simbolo: '·ö¢', puede_invertirse: true,
            significado_corto: 'Fuerza vital, poder, salud.',
            interpretacion: "Conf√≠a en tu poder para superar cualquier desaf√≠o y transforma la adversidad en crecimiento.",
            contenido_expandido: {
                titulo: "Fuerza de la iniciaci√≥n",
                significado_profundo: "Uruz representa al uro o buey salvaje, un animal de fuerza indomable. Apela a la reserva de poder individual que nos habita. En las antiguas tribus, cazar al uro era un rito inici√°tico para los j√≥venes, cuya adultez quedaba sellada al regresar con la presa. Su aparici√≥n sugiere recurrir a las potencias del instinto como motor de vida, autoabastecerse y retroalimentarse.",
                valor_invertido: "Es una runa de sacrificio. No como sometimiento, sino como el acto de 'hacer sagrado', de ofrendar una materia densa para recibir una energ√≠a sutil. Sugiere aceptar lo in√∫til del esfuerzo frente a los dictados del destino.",
                postura: "De pie, con los pies abiertos al ancho de las caderas. Bajar el tronco y los brazos, dejando que la cabeza cuelgue en direcci√≥n al piso, avanzando y golpeando r√≠tmicamente con los pies en la tierra.",
                ritual: null
            }
        },
        { 
            nombre: 'Thurisaz', simbolo: '·ö¶', puede_invertirse: true,
            significado_corto: 'Desaf√≠o, protecci√≥n, pruebas.',
            interpretacion: "Enfrenta los obst√°culos con conciencia; cada desaf√≠o es una oportunidad para fortalecerte.",
            contenido_expandido: {
                titulo: "Fuerza de un gigante",
                significado_profundo: "Representada por el gigante Thor, identifica una acci√≥n potente, directa e irreflexiva. Es una runa de curaci√≥n que desestructura. En las leyendas, Thor rompe con estructuras anteriores para dar lugar a lo nuevo. Cuando aparece, el pasaje de una situaci√≥n a otra es violento o sorpresivo, requiriendo m√°s hechos que palabras.",
                valor_invertido: "Toda la potencia de la runa se vuelve en contra, produciendo enojo por no haber actuado en el momento propicio. El significado puede ser la necesidad de una mirada interior o que toda acci√≥n externa conducir√° al debilitamiento. La sugerencia es observar el paisaje interior en quietud.",
                postura: "De pie con los pies juntos. Los brazos suben por adelante hasta quedar paralelos al suelo a la altura de la boca del est√≥mago, con las palmas hacia abajo y los dedos mayores unidos.",
                ritual: null
            }
        },
        {
            nombre: 'Ansuz', simbolo: '·ö®', puede_invertirse: true,
            significado_corto: 'Palabra, comunicaci√≥n, inspiraci√≥n.',
            interpretacion: "Escucha los mensajes, comun√≠cate desde el coraz√≥n y permite que la verdad se exprese.",
            contenido_expandido: {
                titulo: "En un principio fue el verbo",
                significado_profundo: "Simboliza la voz, la palabra, la poes√≠a. Abre el p√≥rtico del futhark e introduce en los caminos del conocimiento de s√≠. Comunica con los dioses arquet√≠picos que habitan dentro de uno y plasma el pensamiento en sonidos y letras. Representa la autoridad y la comunicaci√≥n con lo divino.",
                valor_invertido: "Significa llamarse a silencio. Puede indicar que la energ√≠a del dios Loki, el enga√±ador, circunda la situaci√≥n y existe la posibilidad de enga√±o o autoenga√±o.",
                postura: "De pie con los pies juntos. Los brazos se elevan por adelante hasta quedar a 45 grados del cuerpo, en actitud de ofrecer. Palmas hacia arriba y la garganta abierta, conectada con las manos en la intenci√≥n de dar la voz.",
                ritual: null
            }
        },
        {
            nombre: 'Raidho', simbolo: '·ö±', puede_invertirse: true,
            significado_corto: 'Viaje, movimiento, evoluci√≥n.',
            interpretacion: "Conf√≠a en el proceso del viaje, cada paso es parte del aprendizaje. El movimiento te llevar√° al equilibrio.",
            contenido_expandido: {
                titulo: "El viaje hacia mi destino",
                significado_profundo: "Significa un largo viaje en carro, un encuentro y comunicaci√≥n a trav√©s de la acci√≥n. Su dise√±o muestra una pierna dando un paso. Representa la decisi√≥n de buscar activamente la meta propuesta, trascendiendo la situaci√≥n actual para ir al encuentro de otros.",
                valor_invertido: "Significa estancamiento, viajes bloqueados, obst√°culos en la comunicaci√≥n y en la acci√≥n. Atascarse en la puerta, ruptura por desencuentro o estancamiento.",
                postura: "De pie, una pierna adelante, como dando un paso. Los brazos acompa√±an el movimiento natural de caminar.",
                ritual: null
            }
        },
        {
            nombre: 'Kenaz', simbolo: '·ö≤', puede_invertirse: true,
            significado_corto: 'Luz, creatividad, revelaciones.',
            interpretacion: "Es tiempo de crear, de encender tu fuego interior y de dejar que tu luz gu√≠e el camino.",
            contenido_expandido: {
                titulo: "El ojo de Dios",
                significado_profundo: "Kenaz (o Kaunaz) es el fuego del conocimiento, la chispa divina y la visi√≥n interna. Es la luz que nos permite ver en la oscuridad, la inspiraci√≥n y la revelaci√≥n. Es la apertura a la sabidur√≠a, el entendimiento y la creatividad.",
                valor_invertido: "Puede indicar confusi√≥n, p√©rdida de claridad, dificultad para ver una soluci√≥n. Dolor que se ampl√≠a hacia adentro, la corrosi√≥n de la autocr√≠tica y el dolor de mirar la propia sombra.",
                postura: "Sentados con piernas abiertas y estiradas a ras del piso. Los brazos se abren hasta quedar paralelos al suelo y abiertos con las palmas de las manos hacia arriba.",
                ritual: null
            }
        },
        {
            nombre: 'Gebo', simbolo: '·ö∑', puede_invertirse: false,
            significado_corto: 'Regalo, intercambio, generosidad.',
            interpretacion: "Da y recibe con amor, busca el equilibrio en tus relaciones y acepta la ayuda que se te ofrece.",
            contenido_expandido: {
                titulo: "El regalo de una pareja equilibrada",
                significado_profundo: "Representa el regalo, la uni√≥n y el equilibrio entre dar y recibir. Simboliza el encuentro de dos partes que se reconocen y logran fundirse, ofrendado a los dioses. Es la runa de la pareja y el intercambio justo. Siempre es positiva.",
                valor_invertido: "Gebo no tiene posici√≥n invertida. Su mensaje es siempre de uni√≥n, regalo o equilibrio.",
                postura: "De pie, abrimos las piernas en el ancho de caderas. Los brazos se elevan por los costados reproduciendo una letra X. El cuerpo forma dos l√≠neas que se cruzan a nivel de la boca del est√≥mago.",
                ritual: null
            }
        },
        {
            nombre: 'Wunjo', simbolo: '·öπ', puede_invertirse: true,
            significado_corto: 'Alegr√≠a, bienestar, √©xito.',
            interpretacion: "Permite que la gratitud y la confianza abran la puerta a la felicidad y al √©xito en tu vida.",
            contenido_expandido: {
                titulo: "Un lugar de llegada para mi alegr√≠a",
                significado_profundo: "Representa la alegr√≠a, la meta alcanzada, la armon√≠a y la felicidad compartida. Simboliza el momento de celebraci√≥n por los logros y la uni√≥n con los dem√°s. Es la cima conquistada y el disfrute del fruto del trabajo.",
                valor_invertido: "Indica tristeza, demoras en obtener resultados, rupturas, p√©rdida de alegr√≠a o disonancia en los v√≠nculos.",
                postura: "De pie, sentimos el suelo bajo los pies y el cielo sobre la cabeza. Los brazos se elevan por adelante, paralelos al piso, con los dedos toc√°ndose y las palmas enfrentadas.",
                ritual: null
            }
        },
        {
            nombre: 'Hagalaz', simbolo: '·ö∫', puede_invertirse: false,
            significado_corto: 'Cambios bruscos, transformaci√≥n.',
            interpretacion: "Acepta los cambios repentinos y ve en ellos una oportunidad. Despu√©s de la tormenta, llega la calma.",
            contenido_expandido: {
                titulo: "El arma de los gigantes de la escarcha",
                significado_profundo: "Simboliza el granizo, las fuerzas destructivas de la naturaleza que traen un cambio y una transformaci√≥n inesperada. Es la runa de la crisis, el quiebre necesario para que surja un nuevo orden. Su efecto es ineludible.",
                valor_invertido: "Hagalaz no tiene posici√≥n invertida, su mensaje es siempre disruptivo y transformador.",
                postura: "De pie con los pies juntos. Los brazos se abren en cruz, exponiendo la parte anterior del t√≥rax. Se busca sentir la sensaci√≥n de estar expuesto.",
                ritual: null
            }
        },
        {
            nombre: 'Nauthiz', simbolo: '·öæ', puede_invertirse: true,
            significado_corto: 'Necesidad, carencia, resistencia.',
            interpretacion: "Acepta tus limitaciones y aprende de ellas. La paciencia y la resiliencia son tus mayores aliadas ahora.",
            contenido_expandido: {
                titulo: "La maestr√≠a que da el dolor",
                significado_profundo: "Es la necesidad, la carencia y el dolor que ense√±a y forja el car√°cter. Simboliza la maestr√≠a que se adquiere a trav√©s del sufrimiento y la superaci√≥n de retos inevitables. Es la runa del aprendizaje a trav√©s de la dificultad.",
                valor_invertido: "Habla del maestro interno. Indica la capacidad de ense√±ar, asistir o comprender a otros a partir de la experiencia de los propios padecimientos. El dolor se transforma en maestr√≠a.",
                postura: "De pie, con los pies juntos. Los brazos se colocan a la altura de la boca del est√≥mago, con los codos flexionados y los antebrazos cruzados, tirando hacia afuera como para aflojar un tornillo.",
                ritual: null
            }
        },
        {
            nombre: 'Isa', simbolo: '·õÅ', puede_invertirse: false,
            significado_corto: 'Estancamiento, pausa, introspecci√≥n.',
            interpretacion: "Te invita a la quietud. No fuerces el avance, aprovecha este tiempo para meditar y reencontrarte.",
            contenido_expandido: {
                titulo: "El hielo. El silencio del movimiento",
                significado_profundo: "Representa el hielo, la quietud y el estancamiento necesario para la reflexi√≥n. Es la pausa antes de la acci√≥n, una introspecci√≥n irremediable. La energ√≠a se concentra en el eje interior, preparando un cambio futuro.",
                valor_invertido: "Isa no tiene posici√≥n invertida. Su mensaje es siempre de quietud, detenci√≥n y mirada interior.",
                postura: "De pie, sentimos el eje de nuestra columna vertebral. Apoyamos los pies en la tierra y abrimos la cabeza al cielo. Observamos la verticalidad.",
                ritual: null
            }
        },
        {
            nombre: 'Jera', simbolo: '·õÉ', puede_invertirse: false,
            significado_corto: 'Ciclo, cosecha, recompensa.',
            interpretacion: "Recompensa el esfuerzo sostenido. Todo ciclo llega a su fin y la cosecha ser√° justa. Conf√≠a en los tiempos.",
            contenido_expandido: {
                titulo: "La paciencia de sostener un ciclo",
                significado_profundo: "Es la cosecha, el ciclo anual, la recompensa que llega tras el esfuerzo y la espera paciente. Simboliza los frutos del trabajo y el respeto por los procesos naturales de la vida. Todo llega a su debido tiempo.",
                valor_invertido: "Jera no tiene posici√≥n invertida. Cuando aparece, se√±ala que un nuevo ciclo comienza, o si sale en el pasado, que ya comenz√≥ y el presente es su fruto.",
                postura: "Es la postura m√°s m√≥vil. De pie, el brazo izquierdo se eleva y toca la cabeza, mientras la pierna izquierda est√° estirada. La pierna derecha se dobla, tocando con el pie la rodilla izquierda. El movimiento es constante y alternado.",
                ritual: null
            }
        },
        {
            nombre: 'Eihwaz', simbolo: '·õá', puede_invertirse: false,
            significado_corto: 'Resistencia, transformaci√≥n profunda.',
            interpretacion: "Es una runa de transformaci√≥n profunda. No temas a los cambios radicales; el renacimiento est√° cerca.",
            contenido_expandido: {
                titulo: "Muerte y transformaci√≥n en el coraz√≥n del futharc",
                significado_profundo: "Representa el tejo, √°rbol sagrado asociado a la muerte y el renacimiento. Simboliza la transformaci√≥n profunda, la superaci√≥n de pruebas y la conexi√≥n entre los mundos. Su lugar est√° en el centro del futhark, es el coraz√≥n y el puente que relaciona lo esencial con lo material.",
                valor_invertido: "Eihwaz no tiene posici√≥n invertida. Su mensaje es siempre de transformaci√≥n, defensa y resistencia.",
                postura: "Nos paramos sobre nuestras rodillas. El ment√≥n baja hasta juntarse con el pecho. Luego, apoyamos los gl√∫teos sobre los talones, en sensaci√≥n de recogimiento.",
                ritual: null
            }
        },
        {
            nombre: 'Perthro', simbolo: '·õà', puede_invertirse: true,
            significado_corto: 'Misterio, destino, intuici√≥n.',
            interpretacion: "Revela misterios y secretos. Conf√≠a en tu intuici√≥n, hay verdades ocultas que pronto saldr√°n a la luz.",
            contenido_expandido: {
                titulo: "El secreto se oculta en nuestro coraz√≥n",
                significado_profundo: "Es la runa de lo misterioso y lo oculto, un asunto secreto que a√∫n no est√° preparado para ser revelado. Se asocia al azar, la suerte y el destino (las Nornas). Representa aquello que permanece en secreto hasta que estemos listos para comprenderlo.",
                valor_invertido: "Significa 'secreto descubierto'. M√°scaras obsoletas que se caen. Lo que fue √∫til para un camino, ya no lo es. La energ√≠a insta a dejar caer todo gesto estereotipado y a procurar la cara del adentro.",
                postura: "Sentados. Apoyamos las plantas de los pies en el piso, con las piernas flexionadas y un poco abiertas. Los codos se apoyan en las rodillas y las manos sostienen la cabeza, en actitud pensativa.",
                ritual: null
            }
        },
        {
            nombre: 'Algiz', simbolo: '·õâ', puede_invertirse: true,
            significado_corto: 'Protecci√≥n, gu√≠a espiritual.',
            interpretacion: "Te protege y conecta con lo sagrado. Deja que la gu√≠a espiritual te oriente y resguarda tu energ√≠a.",
            contenido_expandido: {
                titulo: "La oportunidad de decir no",
                significado_profundo: "Simboliza los cuernos de un alce, que delimitan un espacio libre y protegido. Es la runa de la defensa espiritual, de poner l√≠mites al mal. Representa la conexi√≥n con lo divino y la confianza que emana del coraz√≥n para decir 'no' cuando es necesario.",
                valor_invertido: "Indica una falta de defensas. La persona intenta protegerse aferr√°ndose a las situaciones, lo que muestra una falta de confianza en el proceso de la vida y la deja a merced de posibles manipulaciones.",
                postura: "De pie, con los pies juntos. Elevamos los brazos por el costado hacia arriba. Las palmas quedan hacia fuera y la cabeza se dirige un poco hacia atr√°s, como mirando al cielo. Se busca la sensaci√≥n de delimitar el espacio.",
                ritual: null
            }
        },
        {
            nombre: 'Sowilo', simbolo: '·õã', puede_invertirse: false,
            significado_corto: '√âxito, poder solar, victoria.',
            interpretacion: "Es el sol que ilumina tu camino. El √©xito, la claridad y la vitalidad llegan a tu vida. Avanza con seguridad.",
            contenido_expandido: {
                titulo: "Un camino hacia el Sol",
                significado_profundo: "Es el sol, la victoria sobre la oscuridad, la claridad mental y la energ√≠a vital. Representa la realizaci√≥n, la iluminaci√≥n y la fuerza para lograr las metas. Es una gran luz divina, un esplendor que consuela y trae un gran alivio.",
                valor_invertido: "Sowilo no tiene posici√≥n invertida. Su energ√≠a es siempre de √©xito, claridad y fuerza vital.",
                postura: "De pie, abrimos las piernas en el ancho de caderas y las flexionamos un poco. Los brazos se elevan por adelante, ahuec√°ndose, como si rode√°ramos una gran pelota inflable.",
                ritual: null
            }
        },
        {
            nombre: 'Tiwaz', simbolo: '·õè', puede_invertirse: true,
            significado_corto: 'Justicia, valent√≠a, sacrificio.',
            interpretacion: "Exige justicia y sacrificio. Act√∫a con integridad, s√© valiente y defiende lo que es correcto.",
            contenido_expandido: {
                titulo: "Reposando en la fe",
                significado_profundo: "Es la runa del guerrero Tyr, del autosacrificio por un bien mayor, la fe y la justicia. Simboliza la victoria que se obtiene con honestidad, compromiso y valent√≠a. Encabeza el octeto de las relaciones humanas.",
                valor_invertido: "Indica que la fuerza y el valor se est√°n empleando en el lugar menos indicado. Puede se√±alar una traici√≥n de un pacto, injusticia, falta de fe, derrota y dificultades con la autoestima.",
                postura: "De pie, sentimos los pies en el piso y la c√∫spide de la cabeza en contacto con el cielo. Los brazos se elevan por los costados hasta quedar a 45 grados del cuerpo, imitando una flecha.",
                ritual: null
            }
        },
        {
            nombre: 'Berkano', simbolo: '·õí', puede_invertirse: true,
            significado_corto: 'Nacimiento, crecimiento, fertilidad.',
            interpretacion: "Anuncia nuevos comienzos. Cuida de tus proyectos como una madre y permite que crezcan con amor.",
            contenido_expandido: {
                titulo: "El coraje de lo femenino",
                significado_profundo: "Es la madre tierra, la maternidad, el nacimiento, la fertilidad y el crecimiento. Si Tiwaz es el coraje masculino, Berkano es el coraje femenino, el de parir. Representa el acto de nutrir y sustentar aquello que necesita crecer, ya sean hijos, ideas o sue√±os.",
                valor_invertido: "Significa sobreprotecci√≥n o prioridades mal establecidas. Se est√° alimentando algo que no es lo importante para la situaci√≥n presente. Bajo una apariencia de cuidado, puede ocultarse hostilidad o culpa.",
                postura: "De pie, flexionamos las rodillas y mantenemos los pies apoyados en el suelo. Los brazos se elevan por adelante, los antebrazos se flexionan y las manos llegan a tocar las sienes.",
                ritual: null
            }
        },
        {
            nombre: 'Ehwaz', simbolo: '·õñ', puede_invertirse: true,
            significado_corto: 'Movimiento, progreso, confianza.',
            interpretacion: "Habla de movimiento y colaboraci√≥n. Conf√≠a en quienes te rodean y avanza hacia tus metas en compa√±√≠a.",
            contenido_expandido: {
                titulo: "Un paseo que enlaza universos",
                significado_profundo: "Es el caballo, que simboliza la sinton√≠a entre dos mundos (jinete y caballo, racional e intuitivo). Representa la confianza, la cooperaci√≥n, el trabajo en equipo y el movimiento equilibrado. Alude a un matrimonio, un encuentro o una mudanza para cooperar.",
                valor_invertido: "Indica que el h√©roe precisa descanso. Es momento de pausa para reciclar fuerzas, bajar del caballo y reposar. La continuaci√≥n del movimiento o del viaje est√° desaconsejada.",
                postura: "Se realiza entre dos personas. Se ubican frente a frente, con rodillas levemente flexionadas y las manos tendidas hacia el compa√±ero para tomarse. Se busca la vivencia de compartir.",
                ritual: null
            }
        },
        {
            nombre: 'Mannaz', simbolo: '·õó', puede_invertirse: true,
            significado_corto: 'Humanidad, cooperaci√≥n, autoconocimiento.',
            interpretacion: "Es la humanidad y el autoconocimiento. Reconoce tu valor y busca el apoyo de la comunidad.",
            contenido_expandido: {
                titulo: "La raza humana",
                significado_profundo: "Es el ser humano, la conciencia social y el yo en relaci√≥n con los otros. Simboliza la colaboraci√≥n, la inteligencia colectiva y la autosuperaci√≥n. Representa la estructura, el l√≠mite que proporciona certeza y la ley del origen paterno.",
                valor_invertido: "Soledad, alienaci√≥n y dificultades sociales. La persona est√° repitiendo viejas escenas. El mensaje es 'encuentra tu propia ley'. Llama a no refugiarse en el ego√≠smo y a apelar a la creatividad para salir de un circuito de sufrimiento.",
                postura: "Nos arrodillamos, con el ment√≥n contra el pecho. Cada mano se apoya en el hombro contrario, y los brazos permanecen cruzados en el centro del pecho. La mirada se dirige hacia el ombligo.",
                ritual: null
            }
        },
        {
            nombre: 'Laguz', simbolo: '·õö', puede_invertirse: true,
            significado_corto: 'Intuici√≥n, emociones, flujo.',
            interpretacion: "Fluye como el agua. D√©jate llevar por la intuici√≥n y adapta tus emociones con sabidur√≠a.",
            contenido_expandido: {
                titulo: "Un cuerpo de agua",
                significado_profundo: "Es el agua, la intuici√≥n, la fluidez y las emociones. Su fluir no posee forma, sino que toma el molde de lo que la contiene. Est√° representada por la sacerdotisa, la luna nueva y la energ√≠a femenina como gran fuente de vida. Es la gran igualadora de las emociones.",
                valor_invertido: "Desborde emocional. Puede estar indicando problemas de adicciones o situaciones fuera de control. Puede leerse como 'esto es una locura' y sugiere la necesidad de desahogarse para resolver el estado actual.",
                postura: "De pie con los pies juntos, elevamos los brazos por adelante hasta tomar la posici√≥n de qui√©n est√° por zambullirse a una pileta de nataci√≥n. Se busca sentir la entrega al mundo del agua.",
                ritual: null
            }
        },
        {
            nombre: 'Ingwaz', simbolo: '·õù', puede_invertirse: false,
            significado_corto: 'Potencial, paz interna, culminaci√≥n.',
            interpretacion: "Simboliza paz y culminaci√≥n. Es tiempo de finalizar procesos y disfrutar del merecido descanso.",
            contenido_expandido: {
                titulo: "La potencia de un comienzo",
                significado_profundo: "Es la semilla, el potencial concentrado y la gestaci√≥n de algo nuevo. Representa la culminaci√≥n de un ciclo y el comienzo de otro. Es la transformaci√≥n de la cris√°lida en mariposa, una acci√≥n que posibilita el despertar a la libertad despu√©s de un periodo latente.",
                valor_invertido: "Ingwaz no tiene posici√≥n invertida.",
                postura: "Nos sentamos en forma c√≥moda, con la columna derecha. Los brazos evocan el dise√±o de la runa: se colocan hacia abajo y por los costados, con las manos apoyadas sobre los genitales, como guardianas de la energ√≠a vital.",
                ritual: null
            }
        },
        {
            nombre: 'Othala', simbolo: '·õü', puede_invertirse: true,
            significado_corto: 'Herencia, ra√≠ces, legado.',
            interpretacion: "Conecta con tus ra√≠ces. Honra tu herencia y construye tu propio legado a partir de ella.",
            contenido_expandido: {
                titulo: "El liderazgo que viene de los ancestros",
                significado_profundo: "Es la herencia, el patrimonio, los ancestros y el hogar. Simboliza la transmisi√≥n de valores, la protecci√≥n del linaje y el arraigo. Representa la herencia gen√©tica (ADN) y el legado espiritual (karma o Filgia) que recibimos de nuestros antepasados.",
                valor_invertido: "P√©rdida de ra√≠ces, conflictos familiares, desapego. Habla del peligro de quedar encasillado en estereotipos familiares. Puede se√±alar que la persona no consigue ejercer el liderazgo de su propia vida y cede su poder a otro.",
                postura: "Nos sentamos c√≥modamente, con la espalda derecha. Nuestros brazos se elevan, enmarcando la cabeza y uniendo las puntas de los dedos, como si fuera una casita.",
                ritual: null
            }
        },
        {
            nombre: 'Dagaz', simbolo: '·õû', puede_invertirse: false,
            significado_corto: 'Despertar, transformaci√≥n, nuevos paradigmas.',
            interpretacion: "Es el despertar y la transformaci√≥n. Est√°s a punto de vivir un cambio positivo y revelador.",
            contenido_expandido: {
                titulo: "La irrupci√≥n de la luz",
                significado_profundo: "Es el amanecer, el cambio radical, la iluminaci√≥n y la apertura. Simboliza la transformaci√≥n total y los nuevos comienzos. Es la oportunidad de saltar al abismo con la certeza de que una gran luz nos sostendr√°. Encarna la valent√≠a de caminar en la oscuridad hacia la luz.",
                valor_invertido: "Dagaz no tiene posici√≥n invertida.",
                postura: "Nos sentamos en forma c√≥moda. Elevamos los brazos por adelante hasta que queden paralelos al piso. Flexionamos los antebrazos de modo que las palmas queden unidas y formen un √°ngulo de 90 grados. Lentamente separamos las manos, abri√©ndolas hacia cada costado.",
                ritual: null
            }
        }
    ];

    function openRunaModalByName(nombreRuna, estaInvertida = false) { // Acepta el estado de inversi√≥n
        const r = runas.find(r => r.nombre === nombreRuna);
        if (!r) return;

        const modalOverlay = document.getElementById('runa-modal-overlay');
        const modalImg = document.getElementById('runa-modal-img');
        const modalNombre = document.getElementById('runa-modal-nombre');
        const modalSignificado = document.getElementById('runa-modal-significado');
        const modalInterpretacion = document.getElementById('runa-modal-interpretacion');
        
        modalImg.innerHTML = `<span class="runa-glyph ${estaInvertida ? 'invertida' : ''}">${r.simbolo}</span>`;
        modalNombre.textContent = r.nombre + (estaInvertida ? " (Invertida)" : "");
        modalSignificado.textContent = r.significado_corto || '';
        
        // Muestra la interpretaci√≥n correcta (derecha o invertida)
        if (estaInvertida && r.contenido_expandido.valor_invertido) {
            modalInterpretacion.textContent = r.contenido_expandido.valor_invertido;
        } else {
            modalInterpretacion.textContent = r.interpretacion || '';
        }
        
        const expandido = r.contenido_expandido;
        document.getElementById('runa-modal-titulo').textContent = expandido.titulo || '';
        document.getElementById('runa-modal-significado-profundo').textContent = expandido.significado_profundo || '';
        
        const invertidaWrapper = document.getElementById('runa-modal-invertida-wrapper');
        invertidaWrapper.style.display = expandido.valor_invertido ? 'block' : 'none';
        document.getElementById('runa-modal-invertida').textContent = expandido.valor_invertido || '';

        const posturaWrapper = document.getElementById('runa-modal-postura-wrapper');
        posturaWrapper.style.display = expandido.postura ? 'block' : 'none';
        document.getElementById('runa-modal-postura').textContent = expandido.postura || '';

        const ritualWrapper = document.getElementById('runa-modal-ritual-wrapper');
        ritualWrapper.style.display = expandido.ritual ? 'block' : 'none';
        document.getElementById('runa-modal-ritual').textContent = expandido.ritual || '';

        modalOverlay.classList.add('active');
        document.body.style.overflow = "hidden";
        document.getElementById('runa-modal-close').focus();
    }

    function activarModalEnTiradas() {
        document.querySelectorAll('.tirada-runa-box').forEach(box => {
            const nombre = box.querySelector('.tirada-nombre')?.textContent;
            if (nombre) {
                const estaInvertida = box.dataset.invertida === 'true';
                box.style.cursor = "pointer";
                box.setAttribute('role', 'button');
                box.setAttribute('aria-label', `Ver detalles de la runa ${nombre}`);
                box.tabIndex = 0;
                box.addEventListener('click', () => openRunaModalByName(nombre, estaInvertida));
                box.addEventListener('keydown', (e) => {
                    if (e.key === "Enter" || e.key === " ") { openRunaModalByName(nombre, estaInvertida); e.preventDefault(); }
                });
            }
        });
    }

    document.addEventListener('DOMContentLoaded', function() {
      const navLinks = document.querySelectorAll('#main-nav a[data-section]');
      const sections = document.querySelectorAll('.main-section');
      const ctaOraculo = document.getElementById('cta-oraculo');

      function navigateTo(sectionId) {
          navLinks.forEach(l => l.classList.toggle('active', l.dataset.section === sectionId));
          sections.forEach(sec => sec.classList.toggle('active', sec.id === sectionId));
      }
      navLinks.forEach(link => {
        link.addEventListener('click', (e) => { e.preventDefault(); navigateTo(link.dataset.section); });
      });
      ctaOraculo.addEventListener('click', () => navigateTo('tirada'));

      const galeria = document.getElementById('galeria-runas');
      galeria.innerHTML = runas.map(r => `
        <div class="runa-glyph-container" data-nombre="${r.nombre}" tabindex="0" role="button" aria-label="Ver detalles de ${r.nombre}">
          <span class="runa-glyph">${r.simbolo}</span>
          <span class="runa-nombre-tag">${r.nombre}</span>
        </div>
      `).join('');
      galeria.querySelectorAll('div[data-nombre]').forEach(div => {
        div.addEventListener('click', () => openRunaModalByName(div.dataset.nombre, false)); // En la galer√≠a siempre derechas
        div.addEventListener('keydown', e => { if (e.key === "Enter" || e.key === " ") { openRunaModalByName(div.dataset.nombre, false); e.preventDefault(); } });
      });

      const modalOverlay = document.getElementById('runa-modal-overlay');
      const closeModalBtn = document.getElementById('runa-modal-close');
      const saberMasBtn = document.getElementById('btn-saber-mas');
      const contenidoExpandido = document.getElementById('runa-modal-expandido');
      const modal = document.querySelector('.runa-modal');

      const closeModal = () => { 
          modalOverlay.classList.remove('active'); 
          document.body.style.overflow = "";
          contenidoExpandido.style.display = "none";
          saberMasBtn.textContent = "Saber m√°s...";
      };

      closeModalBtn.addEventListener('click', closeModal);
      modalOverlay.addEventListener('click', e => { if (e.target === modalOverlay) closeModal(); });
      document.addEventListener('keydown', e => { if (e.key === "Escape" && modalOverlay.classList.contains('active')) closeModal(); });

      saberMasBtn.addEventListener('click', () => {
          const isHidden = contenidoExpandido.style.display === 'none';
          contenidoExpandido.style.display = isHidden ? 'block' : 'none';
          saberMasBtn.textContent = isHidden ? 'Mostrar menos' : 'Saber m√°s...';
          if(isHidden) {
            setTimeout(() => modal.scrollTop = modal.scrollHeight, 10);
          }
      });

      const tiradaBtns = document.querySelectorAll('.tipo-btn');
      const explicacion = document.getElementById('explicacion-tirada');
      const preguntaInput = document.getElementById('pregunta');
      const tirarBtn = document.getElementById('iniciar-ritual');
      const tiradaResultado = document.getElementById('tirada-resultado');
      const templates = { simple: document.getElementById('ejemplo-simple').innerHTML, tres: document.getElementById('ejemplo-tres').innerHTML, cruz: document.getElementById('ejemplo-cruz').innerHTML };
      let tipoSeleccionado = 'simple';
      explicacion.innerHTML = templates[tipoSeleccionado];

      tiradaBtns.forEach(btn => {
        btn.addEventListener('click', () => { tipoSeleccionado = btn.dataset.tirada; explicacion.innerHTML = templates[tipoSeleccionado]; tiradaBtns.forEach(b => b.classList.remove('active')); btn.classList.add('active'); });
      });

      preguntaInput.addEventListener('input', () => { tirarBtn.disabled = preguntaInput.value.trim().length === 0; });

      /* --- FUNCI√ìN SACARRUNAS ACTUALIZADA --- */
      function sacarRunas(n) {
        const baraja = [...runas]; 
        let extraidas = [];
        for (let i = 0; i < n && baraja.length > 0; i++) { 
            const runaExtraida = baraja.splice(Math.floor(Math.random() * baraja.length), 1)[0];
            let estaInvertida = false;
            if (runaExtraida.puede_invertirse) {
                estaInvertida = Math.random() < 0.5; // 50% de probabilidad de salir invertida
            }
            extraidas.push({ runa: runaExtraida, invertida: estaInvertida });
        }
        return extraidas;
      }

      tirarBtn.addEventListener('click', () => {
        tiradaResultado.innerHTML = ''; tiradaResultado.style.opacity = 0;
        setTimeout(() => {
          if (tipoSeleccionado === 'simple') {
            const [resultado] = sacarRunas(1);
            tiradaResultado.innerHTML = `<div class="tirada-runas-flex"><div class="tirada-runa-box" data-invertida="${resultado.invertida}"><div class="tirada-pos">Tu Gu√≠a</div><span class="runa-glyph ${resultado.invertida ? 'invertida' : ''}">${resultado.runa.simbolo}</span><span class="tirada-nombre">${resultado.runa.nombre}</span></div></div>`;
          } else if (tipoSeleccionado === 'tres') {
            const resultados = sacarRunas(3); 
            const pos = ['Pasado', 'Presente', 'Futuro'];
            tiradaResultado.innerHTML = `<div class="tirada-runas-flex tres-runas">${resultados.map((r,i) => `<div class="tirada-runa-box" data-invertida="${r.invertida}"><div class="tirada-pos">${pos[i]}</div><span class="runa-glyph ${r.invertida ? 'invertida' : ''}">${r.runa.simbolo}</span><span class="tirada-nombre">${r.runa.nombre}</span></div>`).join('')}</div>`;
          } else if (tipoSeleccionado === 'cruz') {
            const resultados = sacarRunas(5); 
            const pos = [ { label: 'T√∫ / Ahora', class: 'tirada-cruz-centro' }, { label: 'Gu√≠a', class: 'tirada-cruz-arriba' }, { label: 'Ra√≠z', class: 'tirada-cruz-abajo' }, { label: 'Obst√°culo', class: 'tirada-cruz-izquierda' }, { label: 'Futuro', class: 'tirada-cruz-derecha' }];
            tiradaResultado.innerHTML = `<div class="tirada-cruz-layout">${resultados.map((r, i) => `<div class="${pos[i].class} tirada-runa-box" data-invertida="${r.invertida}"><div class="tirada-pos">${pos[i].label}</div><span class="runa-glyph ${r.invertida ? 'invertida' : ''}">${r.runa.simbolo}</span><span class="tirada-nombre">${r.runa.nombre}</span></div>`).join('')}</div>`;
          }
          activarModalEnTiradas();
          tiradaResultado.style.transition = 'opacity 0.5s'; tiradaResultado.style.opacity = 1;
        }, 300);
      });

      const particlesNightConfig = { particles: { number: { value: 100, density: { enable: true, value_area: 800 } }, color: { value: "#d4af37" }, shape: { type: "circle" }, opacity: { value: 0.5, random: true, anim: { enable: true, speed: 1, opacity_min: 0.1, sync: false } }, size: { value: 2, random: true }, line_linked: { enable: false }, move: { enable: true, speed: 0.5, direction: "none", random: true, straight: false, out_mode: "out" } }, interactivity: { events: { onhover: { enable: false } } }, retina_detect: true };
      const particlesDayConfig = { particles: { number: { value: 150, density: { enable: true, value_area: 800 } }, color: { value: ["#8f2c24", "#3a7d44"] }, shape: { type: "circle" }, opacity: { value: 0.6, random: true, anim: { enable: true, speed: 1, opacity_min: 0.2, sync: false } }, size: { value: 2.5, random: true }, line_linked: { enable: false }, move: { enable: true, speed: 0.6, direction: "none", random: true, straight: false, out_mode: "out" } }, interactivity: { events: { onhover: { enable: false } } }, retina_detect: true };

      function setParticles(theme) {
        if (window.pJSDom && window.pJSDom.length > 0) {
            window.pJSDom[0].pJS.fn.vendors.destroypJS();
            window.pJSDom = [];
        }
        const config = theme === 'day' ? particlesDayConfig : particlesNightConfig;
        particlesJS('particles-js', config);
      }
      
      const audioDay = document.getElementById('audio-theme-day');
      const audioNight = document.getElementById('audio-theme-night');
      const muteBtn = document.getElementById('mute-btn');
      const volumeSlider = document.getElementById('volume-slider');
      
      let isMuted = true;
      let currentVolume = 0.3;

      function syncVolume() {
        audioDay.volume = currentVolume;
        audioNight.volume = currentVolume;
      }

      function playCurrentTrack() {
        if (isMuted) return;
        const isDayTheme = document.body.classList.contains('theme-day');
        const toPlay = isDayTheme ? audioDay : audioNight;
        const toPause = isDayTheme ? audioNight : audioDay;

        toPause.pause();
        toPlay.play().catch(e => console.error("La reproducci√≥n autom√°tica fue bloqueada.", e));
      }

      muteBtn.addEventListener('click', () => {
        isMuted = !isMuted;
        muteBtn.textContent = isMuted ? 'üîá' : 'üîä';
        if (isMuted) {
          audioDay.pause();
          audioNight.pause();
        } else {
          playCurrentTrack();
        }
      });
      
      volumeSlider.addEventListener('input', (e) => {
        currentVolume = e.target.value;
        syncVolume();
      });

      const themeToggleBtn = document.getElementById('theme-toggle-btn');
      const iconSun = document.getElementById('icon-sun');
      const iconMoon = document.getElementById('icon-moon');
      const currentTheme = localStorage.getItem('theme') || 'night';

      function setTheme(theme) {
          document.body.classList.toggle('theme-day', theme === 'day');
          iconSun.style.display = theme === 'day' ? 'block' : 'none';
          iconMoon.style.display = theme === 'day' ? 'none' : 'block';
          localStorage.setItem('theme', theme);
          
          playCurrentTrack();
          setParticles(theme);
      }

      syncVolume();
      setTheme(currentTheme);

      themeToggleBtn.addEventListener('click', () => {
          const newTheme = document.body.classList.contains('theme-day') ? 'night' : 'day';
          setTheme(newTheme);
      });

      const chatbotToggle = document.getElementById('chatbot-toggle-btn');
      const chatbotOverlay = document.getElementById('chatbot-overlay');
      const chatbotClose = document.getElementById('chatbot-close-btn');

      const openChatbot = () => {
          chatbotOverlay.classList.add('active');
          document.body.style.overflow = 'hidden';
      };
      const closeChatbot = () => {
          chatbotOverlay.classList.remove('active');
          document.body.style.overflow = '';
      };

      chatbotToggle.addEventListener('click', openChatbot);
      chatbotClose.addEventListener('click', closeChatbot);
      chatbotOverlay.addEventListener('click', (e) => {
          if (e.target === chatbotOverlay) {
              closeChatbot();
          }
      });
      document.addEventListener('keydown', e => {
        if(e.key === "Escape" && chatbotOverlay.classList.contains('active')) {
            closeChatbot();
        }
      });

    });
  </script>
</body>
</html>
